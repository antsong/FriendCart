@{
    Layout = null;
}

<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <meta charset="utf-8" />
    <title>Html5</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <link rel="shortcut icon" href="~/favicon.ico" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="alternate" title="RSS" type="application/rss+xml" href="~/rss" />
    <!--[if lt IE 9]>
        <script src="~/scripts/html5shiv.js"></script>
    <![endif]-->
    <style>
        .sparkley {
            background: #3e5771;
            color: white;
            border: none;
            padding: 16px 36px;
            font-weight: normal;
            border-radius: 3px;
            transition: all 0.25s ease;
            box-shadow: 0 38px 32px -23px black;
            margin: 0 1em 1em;
        }

            .sparkley:hover {
                background: #2c3e50;
                color: rgba(255, 255, 255, 0.2);
            }
    </style>
    <style>
        html, body, div, span, applet, object, iframe, h1, h2, h3, h4, h5, h6, p, blockquote, pre, a, abbr, acronym, address, big, cite, code, del, dfn, em, img, ins, kbd, q, s, samp, small, strike, strong, sub, sup, tt, var, b, u, i, center, dl, dt, dd, ol, ul, li, fieldset, form, label, legend, table, caption, tbody, tfoot, thead, tr, th, td, article, aside, canvas, details, embed, figure, figcaption, footer, header, hgroup, menu, nav, output, ruby, section, summary, time, mark, audio, video {
            margin: 0;
            padding: 0;
            border: 0;
            font-size: 100%;
            font: inherit;
            vertical-align: baseline;
        }

        article, aside, details, figcaption, figure, footer, header, hgroup, menu, nav, section {
            display: block;
        }

        body {
            line-height: 1;
        }

        ol, ul {
            list-style: none;
        }

        blockquote, q {
            quotes: none;
        }

            blockquote:before, blockquote:after, q:before, q:after {
                content: '';
                content: none;
            }

        table {
            border-collapse: collapse;
            border-spacing: 0;
        }

        * {
            box-sizing: border-box;
        }

        html, body {
            height: 100%;
        }

        body {
            overflow: hidden;
            background: black;
        }

        .wrap {
            height: 100%;
            transform-style: preserve-3d;
            perspective: 400px;
            width: 1000px;
            margin: 0 auto;
        }

        .box {
            transform-style: preserve-3d;
            perspective: 5000px;
            position: absolute;
            width: 50px;
            height: 200px;
            top: 50%;
            margin-top: -100px;
            animation: spin 3s infinite alternate;
        }

        .side, .top, .bottom {
            position: absolute;
        }

        .top, .bottom {
            width: 50px;
            height: 50px;
        }

        .top {
            transform: translateZ(100px);
        }

        .bottom {
            transform: rotateY(180deg) translateZ(100px);
        }

        .side:nth-child(3) {
            transform: rotateX(90deg) translateZ(50px);
            width: 50px;
            height: 200px;
        }

        .side:nth-child(4) {
            width: 200px;
            height: 50px;
            transform: rotateY(90deg) translateZ(-100px);
        }

        .side:nth-child(5) {
            width: 200px;
            height: 50px;
            transform: rotateY(-90deg) translateZ(50px);
        }

        .side:nth-child(6) {
            width: 50px;
            height: 200px;
            transform: rotateX(-90deg) translateZ(-100px);
        }

        .box:nth-child(1) {
            left: 0px;
            animation-delay: -0.075s;
        }

            .box:nth-child(1) div {
                background: rgba(255, 64, 0, 0.3);
                border: 1px solid #ff4000;
            }

        .box:nth-child(2) {
            left: 50px;
            animation-delay: -0.15s;
        }

            .box:nth-child(2) div {
                background: rgba(255, 128, 0, 0.3);
                border: 1px solid #ff8000;
            }

        .box:nth-child(3) {
            left: 100px;
            animation-delay: -0.225s;
        }

            .box:nth-child(3) div {
                background: rgba(255, 191, 0, 0.3);
                border: 1px solid #ffbf00;
            }

        .box:nth-child(4) {
            left: 150px;
            animation-delay: -0.3s;
        }

            .box:nth-child(4) div {
                background: rgba(255, 255, 0, 0.3);
                border: 1px solid yellow;
            }

        .box:nth-child(5) {
            left: 200px;
            animation-delay: -0.375s;
        }

            .box:nth-child(5) div {
                background: rgba(191, 255, 0, 0.3);
                border: 1px solid #bfff00;
            }

        .box:nth-child(6) {
            left: 250px;
            animation-delay: -0.45s;
        }

            .box:nth-child(6) div {
                background: rgba(128, 255, 0, 0.3);
                border: 1px solid #80ff00;
            }

        .box:nth-child(7) {
            left: 300px;
            animation-delay: -0.525s;
        }

            .box:nth-child(7) div {
                background: rgba(64, 255, 0, 0.3);
                border: 1px solid #40ff00;
            }

        .box:nth-child(8) {
            left: 350px;
            animation-delay: -0.6s;
        }

            .box:nth-child(8) div {
                background: rgba(0, 255, 0, 0.3);
                border: 1px solid lime;
            }

        .box:nth-child(9) {
            left: 400px;
            animation-delay: -0.675s;
        }

            .box:nth-child(9) div {
                background: rgba(0, 255, 64, 0.3);
                border: 1px solid #00ff40;
            }

        .box:nth-child(10) {
            left: 450px;
            animation-delay: -0.75s;
        }

            .box:nth-child(10) div {
                background: rgba(0, 255, 128, 0.3);
                border: 1px solid #00ff80;
            }

        .box:nth-child(11) {
            left: 500px;
            animation-delay: -0.825s;
        }

            .box:nth-child(11) div {
                background: rgba(0, 255, 191, 0.3);
                border: 1px solid #00ffbf;
            }

        .box:nth-child(12) {
            left: 550px;
            animation-delay: -0.9s;
        }

            .box:nth-child(12) div {
                background: rgba(0, 255, 255, 0.3);
                border: 1px solid cyan;
            }

        .box:nth-child(13) {
            left: 600px;
            animation-delay: -0.975s;
        }

            .box:nth-child(13) div {
                background: rgba(0, 191, 255, 0.3);
                border: 1px solid deepskyblue;
            }

        .box:nth-child(14) {
            left: 650px;
            animation-delay: -1.05s;
        }

            .box:nth-child(14) div {
                background: rgba(0, 127, 255, 0.3);
                border: 1px solid #007fff;
            }

        .box:nth-child(15) {
            left: 700px;
            animation-delay: -1.125s;
        }

            .box:nth-child(15) div {
                background: rgba(0, 64, 255, 0.3);
                border: 1px solid #0040ff;
            }

        .box:nth-child(16) {
            left: 750px;
            animation-delay: -1.2s;
        }

            .box:nth-child(16) div {
                background: rgba(0, 0, 255, 0.3);
                border: 1px solid blue;
            }

        .box:nth-child(17) {
            left: 800px;
            animation-delay: -1.275s;
        }

            .box:nth-child(17) div {
                background: rgba(64, 0, 255, 0.3);
                border: 1px solid #4000ff;
            }

        .box:nth-child(18) {
            left: 850px;
            animation-delay: -1.35s;
        }

            .box:nth-child(18) div {
                background: rgba(127, 0, 255, 0.3);
                border: 1px solid #7f00ff;
            }

        .box:nth-child(19) {
            left: 900px;
            animation-delay: -1.425s;
        }

            .box:nth-child(19) div {
                background: rgba(191, 0, 255, 0.3);
                border: 1px solid #bf00ff;
            }

        .box:nth-child(20) {
            left: 950px;
            animation-delay: -1.5s;
        }

            .box:nth-child(20) div {
                background: rgba(255, 0, 255, 0.3);
                border: 1px solid magenta;
            }

        @@keyframes spin {
            0% {
                transform: translateZ(-300px) rotateX(90deg);
            }

            25% {
                transform: translateZ(-300px) rotateX(90deg);
            }

            75% {
                transform: rotateX(-90deg);
            }

            100% {
                transform: rotateX(-90deg);
            }
        }
    </style>

</head>
<body>
    <audio src="../../content/Media/%e6%a2%81%e9%9d%99%e8%8c%b9%20-%20%e4%bc%9a%e5%91%bc%e5%90%b8%e7%9a%84%e7%97%9b.mp3" autoplay="autoplay"></audio>
    <div>
        <h1>A little canvas script to <span>add magic</span> to DOM elements!</h1>

        <button class="sparkley">Everything's better with sparkles!</button>
        <button class="sparkley last">I eat rainbows and poop butterflies!!</button>
    </div>

    <div class='wrap'>
        @for (int i = 0; i < 20; i++)
        {
            <div class='box'>
                <div class='top'></div>
                <div class='bottom'></div>
                <div class='side'></div>
                <div class='side'></div>
                <div class='side'></div>
                <div class='side'></div>
            </div>
        }
    </div>
    <script src="~/scripts/jquery-1.11.2.min.js"></script>
    <script>
        $(function () {

            // default is varying levels of transparent white sparkles
            $(".sparkley:first").sparkleh();

            // rainbow as a color generates random rainbow colros
            // count determines number of sparkles
            // overlap allows sparkles to migrate... watch out for other dom elements though.
            $(".sparkley:last").sparkleh({
                color: "rainbow",
                count: 100,
                overlap: 10
            });

            // here we create fuscia sparkles
            $("h1").sparkleh({
                count: 80,
                color: "#ff0080"
            });

            $("p").sparkleh({
                count: 20,
                color: "#00ff00"
            });

            // an array can be passed, too for colours
            // for an image, the image needs to be fully loaded to set
            // the canvas to it's height/width.
            $("#image").imagesLoaded(function () {
                $(".img").sparkleh({
                    count: 25,
                    color: ["#00afec", "#fb6f4a", "#fdfec5"]
                });
            });

        });

        $.fn.sparkleh = function (options) {

            return this.each(function (k, v) {

                var $this = $(v).css("position", "relative");

                var settings = $.extend({
                    width: $this.outerWidth(),
                    height: $this.outerHeight(),
                    color: "#FFFFFF",
                    count: 30,
                    overlap: 0
                }, options);

                var sparkle = new Sparkle($this, settings);

                $this.on({
                    "mouseover focus": function (e) {
                        sparkle.over();
                    },
                    "mouseout blur": function (e) {
                        sparkle.out();
                    }
                });

            });

        }

        function Sparkle($parent, options) {
            this.options = options;
            this.init($parent);
        }

        Sparkle.prototype = {

            "init": function ($parent) {

                var _this = this;

                this.$canvas =
                  $("<canvas>")
                    .addClass("sparkle-canvas")
                    .css({
                        position: "absolute",
                        top: "-" + _this.options.overlap + "px",
                        left: "-" + _this.options.overlap + "px",
                        "pointer-events": "none"
                    })
                    .appendTo($parent);

                this.canvas = this.$canvas[0];
                this.context = this.canvas.getContext("2d");
                this.sprite = new Image();

                this.canvas.width = this.options.width + (this.options.overlap * 2);
                this.canvas.height = this.options.height + (this.options.overlap * 2);

                this.sprites = [0, 6, 13, 20];
                this.particles = this.createSparkles(this.canvas.width, this.canvas.height);

                this.anim = null;
                this.fade = false;

            },

            "createSparkles": function (w, h) {

                var holder = [];

                for (var i = 0; i < this.options.count; i++) {

                    var color = this.options.color;

                    if (this.options.color == "rainbow") {
                        color = '#' + Math.floor(Math.random() * 16777215).toString(16);
                    } else if ($.type(this.options.color) === "array") {
                        color = this.options.color[Math.floor(Math.random() * this.options.color.length)];
                    }

                    holder[i] = {
                        position: {
                            x: Math.floor(Math.random() * w),
                            y: Math.floor(Math.random() * h)
                        },
                        style: this.sprites[Math.floor(Math.random() * 4)],
                        delta: {
                            x: Math.floor(Math.random() * 1000) - 500,
                            y: Math.floor(Math.random() * 1000) - 500
                        },
                        size: parseFloat((Math.random() * 2).toFixed(2)),
                        color: color
                    };

                }

                return holder;

            },

            "draw": function (time, fade) {

                var ctx = this.context;
                var img = this.sprite;
                img.src = this.datauri;

                ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);

                for (var i = 0; i < this.options.count; i++) {

                    var derpicle = this.particles[i];
                    var modulus = Math.floor(Math.random() * 7);

                    if (Math.floor(time) % modulus === 0) {
                        derpicle.style = this.sprites[Math.floor(Math.random() * 4)];
                    }

                    ctx.save();
                    ctx.globalAlpha = derpicle.opacity;
                    ctx.drawImage(img, derpicle.style, 0, 7, 7, derpicle.position.x, derpicle.position.y, 7, 7);

                    if (this.options.color) {

                        ctx.globalCompositeOperation = "source-atop";
                        ctx.globalAlpha = 0.5;
                        ctx.fillStyle = derpicle.color;
                        ctx.fillRect(derpicle.position.x, derpicle.position.y, 7, 7);

                    }

                    ctx.restore();

                }

            },

            "update": function () {

                var _this = this;

                this.anim = window.requestAnimationFrame(function (time) {

                    for (var i = 0; i < _this.options.count; i++) {

                        var u = _this.particles[i];

                        var randX = (Math.random() > Math.random() * 2);
                        var randY = (Math.random() > Math.random() * 3);

                        if (randX) {
                            u.position.x += (u.delta.x / 1500);
                        }

                        if (!randY) {
                            u.position.y -= (u.delta.y / 800);
                        }

                        if (u.position.x > _this.canvas.width) {
                            u.position.x = -7;
                        } else if (u.position.x < -7) {
                            u.position.x = _this.canvas.width;
                        }

                        if (u.position.y > _this.canvas.height) {
                            u.position.y = -7;
                            u.position.x = Math.floor(Math.random() * _this.canvas.width);
                        } else if (u.position.y < -7) {
                            u.position.y = _this.canvas.height;
                            u.position.x = Math.floor(Math.random() * _this.canvas.width);
                        }

                        if (_this.fade) {
                            u.opacity -= 0.02;
                        } else {
                            u.opacity -= 0.005;
                        }

                        if (u.opacity <= 0) {
                            u.opacity = (_this.fade) ? 0 : 1;
                        }

                    }

                    _this.draw(time);

                    if (_this.fade) {
                        _this.fadeCount -= 1;
                        if (_this.fadeCount < 0) {
                            window.cancelAnimationFrame(_this.anim);
                        } else {
                            _this.update();
                        }
                    } else {
                        _this.update();
                    }

                });

            },

            "cancel": function () {

                this.fadeCount = 100;

            },

            "over": function () {

                window.cancelAnimationFrame(this.anim);

                for (var i = 0; i < this.options.count; i++) {
                    this.particles[i].opacity = Math.random();
                }

                this.fade = false;
                this.update();

            },

            "out": function () {

                this.fade = true;
                this.cancel();

            },

            "datauri": "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABsAAAAHCAYAAAD5wDa1AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyRpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYxIDY0LjE0MDk0OSwgMjAxMC8xMi8wNy0xMDo1NzowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNS4xIE1hY2ludG9zaCIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozNDNFMzM5REEyMkUxMUUzOEE3NEI3Q0U1QUIzMTc4NiIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozNDNFMzM5RUEyMkUxMUUzOEE3NEI3Q0U1QUIzMTc4NiI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjM0M0UzMzlCQTIyRTExRTM4QTc0QjdDRTVBQjMxNzg2IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjM0M0UzMzlDQTIyRTExRTM4QTc0QjdDRTVBQjMxNzg2Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+jzOsUQAAANhJREFUeNqsks0KhCAUhW/Sz6pFSc1AD9HL+OBFbdsVOKWLajH9EE7GFBEjOMxcUNHD8dxPBCEE/DKyLGMqraoqcd4j0ChpUmlBEGCFRBzH2dbj5JycJAn90CEpy1J2SK4apVSM4yiKonhePYwxMU2TaJrm8BpykpWmKQ3D8FbX9SOO4/tOhDEG0zRhGAZo2xaiKDLyPGeSyPM8sCxr868+WC/mvu9j13XBtm1ACME8z7AsC/R9r0fGOf+arOu6jUwS7l6tT/B+xo+aDFRo5BykHfav3/gSYAAtIdQ1IT0puAAAAABJRU5ErkJggg=="

        };

        // $('img.photo',this).imagesLoaded(myFunction)
        // execute a callback when all images have loaded.
        // needed because .load() doesn't work on cached images

        // mit license. paul irish. 2010.
        // webkit fix from Oren Solomianik. thx!

        // callback function is passed the last image to load
        //   as an argument, and the collection as `this`

        $.fn.imagesLoaded = function (callback) {
            var elems = this.filter('img'),
                len = elems.length,
                blank = "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==";

            elems.bind('load.imgloaded', function () {
                if (--len <= 0 && this.src !== blank) {
                    elems.unbind('load.imgloaded');
                    callback.call(elems, this);
                }
            }).each(function () {
                // cached images don't fire load sometimes, so we reset src.
                if (this.complete || this.complete === undefined) {
                    var src = this.src;
                    // webkit hack from http://groups.google.com/group/jquery-dev/browse_thread/thread/eee6ab7b2da50e1f
                    // data uri bypasses webkit log warning (thx doug jones)
                    this.src = blank;
                    this.src = src;
                }
            });

            return this;
        };
    </script>

</body>
</html>
